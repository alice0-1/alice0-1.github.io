
<!DOCTYPE html>
<html lang="zh-CN">
    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width,initial-scale=1.0,maximum-scale=1.0,user-scalable=0">
        <title>𝓐𝓵𝓲𝓬𝓮01</title>
        <meta name="author" content="alice01">
        <meta name="description" content="𝓗𝓪𝓹𝓹𝔂 𝓼𝓾𝓰𝓪𝓻 𝓵𝓲𝓯𝓮.">
        <meta name="keywords" content="">
        <link rel="icon" href="/images/avatar.jpg">
        <script src="https://cdn.staticfile.org/instant.page/5.1.0/instantpage.min.js" type="module"></script>
        <script src="https://cdn.staticfile.org/font-awesome/6.1.1/js/all.min.js"></script>
        <link rel="stylesheet" href="/css/fonts.min.css">
        <link rel="stylesheet" href="/css/particlex.css">
        <script src="https://cdn.staticfile.org/vue/3.2.33/vue.global.prod.min.js"></script>
    <meta name="generator" content="Hexo 6.2.0"></head>
    <body>
        <div id="loading" style="height:100vh;width:100vw;position:fixed;display:flex;z-index:200;justify-content:space-between;background:#fff;transition:opacity 0.3s ease-out"><div style="position:fixed;height:100vh;width:100vw;display:flex;justify-content:center;align-items:center"><div id="loadcontent" style="width:50vmin;height:50vmin;padding:50px;border-radius:50%;display:flex;justify-content:center;align-items:center;border:solid 10px #a3ddfb;text-align:center"><div><h2>LOADING...</h2><p style="word-break:keep-all">加载过慢请开启缓存(浏览器默认开启)</p><div><img alt="loading" src="/loading.gif"></div></div></div></div></div>
        <div id="layout">
            <i data-fa-symbol="calendar-solid" class="fa-solid fa-calendar fa-fw"></i>
            <i data-fa-symbol="bookmark-solid" class="fa-solid fa-bookmark fa-fw"></i>
            <i data-fa-symbol="tags-solid" class="fa-solid fa-tags fa-fw"></i>
            <transition name="into">
                <div v-show="show_page" style="display: -not-none">
                    <div id="menu_show">
                         
<nav id="menu">
    <div class="desktop-menu">
        <a href="/">
            <span class="title">𝓐𝓵𝓲𝓬𝓮01</span>
        </a>
        
        <a href="/">
            <i class="fa-solid fa-house fa-fw"></i>
            <span>&ensp;home</span>
        </a>
        
        <a href="/about">
            <i class="fa-solid fa-id-card fa-fw"></i>
            <span>&ensp;about</span>
        </a>
        
        <a href="/archives">
            <i class="fa-solid fa-box-archive fa-fw"></i>
            <span>&ensp;archives</span>
        </a>
        
        <a href="/categories">
            <i class="fa-solid fa-bookmark fa-fw"></i>
            <span>&ensp;categories</span>
        </a>
        
        <a href="/tags">
            <i class="fa-solid fa-tags fa-fw"></i>
            <span>&ensp;tags</span>
        </a>
        
    </div>
    <div :class="'phone-menu ' + menu_show" id="phone-menu">
        <div class="curtain" @click="menu_show = !menu_show" v-show="menu_show"></div>
        <div :class="'title'" @click="menu_show = !menu_show">
            <i class="fa-solid fa-bars fa-fw"></i>
            <span>&emsp;𝓐𝓵𝓲𝓬𝓮01</span>
        </div>
        <transition name="slide">
        <div class="items" v-show="menu_show">
            
            <a href="/">
                <div class="item">
                    <div style="min-width: 20px; max-width: 50px; width: 10%">
                        <i class="fa-solid fa-house fa-fw"></i>
                    </div>
                    <div style="min-width: 100px; max-width: 150%; width: 20%">home</div>
                </div>
            </a>
            
            <a href="/about">
                <div class="item">
                    <div style="min-width: 20px; max-width: 50px; width: 10%">
                        <i class="fa-solid fa-id-card fa-fw"></i>
                    </div>
                    <div style="min-width: 100px; max-width: 150%; width: 20%">about</div>
                </div>
            </a>
            
            <a href="/archives">
                <div class="item">
                    <div style="min-width: 20px; max-width: 50px; width: 10%">
                        <i class="fa-solid fa-box-archive fa-fw"></i>
                    </div>
                    <div style="min-width: 100px; max-width: 150%; width: 20%">archives</div>
                </div>
            </a>
            
            <a href="/categories">
                <div class="item">
                    <div style="min-width: 20px; max-width: 50px; width: 10%">
                        <i class="fa-solid fa-bookmark fa-fw"></i>
                    </div>
                    <div style="min-width: 100px; max-width: 150%; width: 20%">categories</div>
                </div>
            </a>
            
            <a href="/tags">
                <div class="item">
                    <div style="min-width: 20px; max-width: 50px; width: 10%">
                        <i class="fa-solid fa-tags fa-fw"></i>
                    </div>
                    <div style="min-width: 100px; max-width: 150%; width: 20%">tags</div>
                </div>
            </a>
            
        </div>
        </transition>
    </div>
</nav>
                    </div>
                    <div id="main">
                        <div id="home-head">
    <div id="home-background" style="background-image: url(/images/background.jpg)"></div>
    
    <div id="home-info" class="home-info" @click="home_click">
        <span class="loop"></span>
        <span class="loop"></span>
        <span class="loop"></span>
        <span class="loop"></span>
        <span class="info">
            <div class="wrap">
                <h1>𝓐𝓵𝓲𝓬𝓮01</h1>
                <h3></h3>
                <h5>𝓗𝓪𝓹𝓹𝔂 𝓼𝓾𝓰𝓪𝓻 𝓵𝓲𝓯𝓮.</h5>
            </div>
        </span>
    </div>
    
</div>

<div id="home-posts-wrap" class=>
    <div id="home-posts">
        <div id="posts">
            

<div class="post">
    <a href="/2023/12/04/hvv蓝队/">
        <h2>
            蓝队日志基础
        </h2>
    </a>
    <div class="category-and-date">
        
        <span class="date">
            <span class="icon">
                <svg class="fa-icon"><use xlink:href="#calendar-solid"></use></svg>
            </span>
            2023/12/4
        </span>
    </div>
    <div class="excerpt">
        <div class="content" v-pre>
            
            <p>流程:准备-检测-遏制-根除-恢复-跟踪报告</p>
<p>windows日志<br>    开机启动项:msconfig | regedit&gt;users&amp;&amp;machine<br>    临时文件:%temp%<br>    最近文件:%userprofile%\recent<br>    端口netstat<br>    进程:msinfo32&gt;software environment&gt;running tasks	查找进程:tasklist | findstr “PID”	关闭进程： taskkill &#x2F;PID<br>    计划任务: at<br>    账户:net user 隐藏账户$ 通过图形化日志查找<br>    系统(补丁):systeminfo<br>    本地用户和组:lusrmgr.msc<br>    日志:eventvwr.msc<br>    服务:services.msc</p>
<p>linux日志<br>    开机自启:etc&#x2F;init.d<br>    临时文件:etc&#x2F;temp<br>    时间查找:find .&#x2F; -$time $ -name “.$”<br>    端口:netstat<br>    进程:ps aux<br>    登录:last -i<br>    用户:etc&#x2F;passwd etc&#x2F;shadow<br>    历史:root&#x2F;.bash_history<br>    计划任务:crontab<br>    日志:var&#x2F;log<br>    $path:echo $path</p>

            
        </div>
    </div>
    <div class="post-tags">
        
        
    </div>
    <a href="/2023/12/04/hvv蓝队/" class="go-post">
        阅读全文
    </a>
</div>

<div class="post">
    <a href="/2023/04/18/蓝队面试/">
        <h2>
            蓝队面试
        </h2>
    </a>
    <div class="category-and-date">
        
        <span class="date">
            <span class="icon">
                <svg class="fa-icon"><use xlink:href="#calendar-solid"></use></svg>
            </span>
            2023/4/18
        </span>
    </div>
    <div class="excerpt">
        <div class="content" v-pre>
            
            <p>欺骗防御系统_蜜罐 入侵防护系_ips 入侵检测系统_ids web应用安全防护系统_waf 终端高级威胁检测与响应系统_edr安全管理与态势感知平台_csa超融合检测探针_csp 全流量分析取证系统_nft 高级持续性威胁检测和管理系统_tar</p>
<p>应急响应<br>1.准备已经编译好的工具以及取证分析等工具干净可靠放U盘<br>2.初步判断事件的类型，是被入侵、ddos还是其它的原因<br>3.首先抑制范围、影响范围，隔离使受害面不继续扩大。<br>4.寻找原因,封堵攻击源。<br>5.把业务恢复至正常水平<br>6.监控有无异常，报告、管理环节的自省和改进措施。</p>
<p>溯源: 攻击源捕获-溯源处置-攻击者画像<br>捕获(1)审查邮件钓鱼 分析数据 网络资产运行状态 中间件日志 蜜罐追踪	<br>处置(2)域名&#x2F;ip&#x2F;身份&#x2F;文件查询<br>画像(3)路径 目的 代理 手法 </p>
<p>渗透测试流程<br>信息收集 漏洞扫描 手动挖掘 验证漏洞 修复建议 复验漏洞 输出报告</p>
<p>rce:没对接口输入内容严格判断,造成攻击者构造的代码非法执行<br>    防御: (1)用json不用eval(2)用eval的地方严格处理数据</p>
<p>csrf: 攻击者盗用了受害者的身份，以受害者的名义发送恶意请求<br>    防御: (1)验证referer	(2)验证token		{[token安全级更高 因为随机且不可泄露]}</p>
<p>xxe: 由于程序在解析XML数据时,解析了攻击者伪造的xml<br>    危害: (1)加载恶意外部文件 (2)文件读取 (3)命令执行 (4)内网端口扫描 (5)攻击内网<br>    防御: XML数据,如果使用程序为PHP,将libxml_disable_entity_loader设为TRUE来禁用外部实体</p>
<p>ssrf: 利用一个可以发网络请求的服务当跳板来攻击内部其他服务<br>原因:服务器对其他服务器资源进行请求，没有做合法性验证<br>防御: (1)url白名单(2)校验返回内容(3)域名识别ip 过滤内部ip </p>
<p>反序列化: 序列化是程序将对象转化为字节序列,便于存储运输的方式，反序列化与其相反,如果这些函数在传参时没有严格过滤，那么就可以构造恶意代码并将其序列化后传入函数中，从而导致反序列化漏洞。 </p>
<p>upload: 对用户文件上传部分的控制不足或处理缺陷,导致用户可以越权限向服务器上传可执行的动态脚本文件<br>    防御: (1)后端验证(2)mime验证(3)后缀检测(4)内容检测(5)自带函数过滤(6)waf</p>
<p>include: 引入一段用户能控制的脚本或代码,并让服务器端执行include()等函数通过动态变量的方式引入需要包含的文件,用户能够控制该动态变量<br>    伪协议: (1)file (2)http (3)ftp (4)php (5)data (6)ssh2 (7)expect (8)zlib<br>    防御: (1) allow_url_include&#x3D;off (2) open_basedir&#x3D;指定目录(3)魔术引号(4)改日志路径</p>
<p>sqli原理:把SQL语句插入Web表单,提交请求的查询字符串,骗服务器执行恶意的SQL命令<br> 注入点类型分类<br>       数字类型的注入<br>       字符串类型的注入<br>       搜索型注入<br> 提交方式分类<br>       GET注入<br>       POST注入<br>       COOKIE注入<br>       HTTP头注入(XFF注入、UA注入、REFERER注入）<br> 获取信息的方式分类<br>       基于布尔的盲注<br>       基于时间的盲注<br>       基于报错的注入<br>       联合查询注入<br>       堆查询注入 (可同时执行多条语句)</p>
<p>宽字节注入: mysql在使用GBK编码的时候，认为两个字符是一个汉字<br>绕过: (1)大小写 (2)双写 (3)空格 (4)注释符号绕过 (5)十六进制绕过 (6)ascii码绕过<br>防御: (1)过滤,转义,替换,删除 (2)预编译 (3)限制关键字,限制输入长度 (4)waf</p>
<p>xss原理: 将恶意js插入Web页面中，当用户浏览页面时，这些会被触发<br>反射型: 恶意代码并没有保存在目标网站，而Web应用程序把该恶意脚本“反射”回受害者的浏览器<br>存储型: 应用程序未检验数据是否存在XSS，便将其存入数据库。当下一次从数据库获取该数据,页面再次执行XSS代码<br>DOM型: 不与后台服务器数据交互,通过DOM操作前端代码输出的时候产生的问题。<br>绕过: (1)大小写(2)事件(3)空格(4)堆叠(5)伪协议<br>防御: (1)对输入内容编码(2)对重要cookie httponly (3)urlencode检测</p>
<p>信息收集:ip 端口 子域名 旁站 c段 waf 目录 cms 网络空间搜索引擎 谷歌语法 whois</p>
<p>CDN ip:DNS历史解析记录 网络空间安全引擎(fofa) 多地ping看是否有cdn</p>
<p>逻辑漏洞:验证码复用-暴力破解,短信&#x2F;邮件轰炸,未授权访问,越权,并发,支付金额修改</p>
<p>端口: db25000 mysql3306 sqlserver1422 mssql1433 redis6379 Oracle1521 ftp21 ssh22 telnet23 smtp25 http443 weblogic7001 openssl443  </p>
<p>越权判断<br>例如修改一些参数值，id为0还是1、admin为true还是false等</p>
<p>同源策略:同协议,端口,域名共享cookie</p>
<p>sql注入盲注sleep()函数禁用<br>使用同样功能的函数代替，比如benchmark() Get_lock()函数</p>
<p>常用的报错注入的函数<br>floor()函数、exp()函数、updatexml()函数、join()函数</p>
<p>redis数据库和常见的漏洞<br>答：redis是一个非关系型数据库,默认端口6379。常见漏洞是未授权,攻击者无需认证就可以访问内部数据,也能getshell。</p>
<p>二次注入<br>第一次插入数据时，仅使用了<code>addslashes</code>或借助<code>get_magic_quotes_gpc</code>对其中特殊字符转义，在写入数据库的时候还是保留了原来的数据，但是数据本身还是脏数据。在将数据存入到了数据库中之后，开发者就认为数据是可信的。在下一次进行需要进行查询的时候，直接从数据库中取出了脏数据，没有进行进一步的检验和处理，这样就会造成SQL的二次注入</p>
<p>菜刀流量特征: 使用了base64的方式加密了发送给“菜刀马”的指令，其中的两个关键payload z1和z2，这 个名字是可变的</p>
<p>蚁剑流量特征: 默认的user-agent是antsword xxx,但是可以通过修改&#x2F;modules&#x2F;request.js 文件中请求UA绕过 其中流量最中明显的特征为@ini_set(“display_errors”,”0”);这段代码基本是所有 WebShell客户端链接PHP类WebShell都有的一种代码<br>蚁剑混淆加密后还有一个比较明显的特征,即为参数名大多以“_0x……&#x3D;”这种形式（下划 线可替换），所以以_0x开头的参数名也很可能就是恶意流量</p>
<p>冰蝎流量特征:流量动态加密<br>看包没有发现什么特征，但是可以发现它是POST请求的<br>1.	Accept头有application&#x2F;xhtml+xmlapplication&#x2F;xmlapplication&#x2F;signedexchange属于弱特征（UA头的浏览器版本很老）<br>2.	特征分析Content-Type: application&#x2F;octet-stream 这是一个强特征查阅资料可 知octet-stream的意思是，只能提交二进制，而且只能提交一个二进制，如果提交文件的 话，只能提交一个文件,后台接收参数只能有一个，而且只能是流（或者字节数组）；很少使用<br>冰蝎 二 默认Accept字段的值很特殊,而且每个阶段都一样冰蝎内置了十余种UserAgent ，每次连接 shell 会随机选择一个进行使用。但都是比较老的，r容易被检测到，但是可以在burp中修改 ua头。<br>Content-Length: 16, 16就是冰蝎2连接的特征<br>冰蝎 三 取消动态密钥获取，目前很多waf等设备都做了冰蝎2的流量特征分析，所以3取消了动态密钥获取php抓包看包没有发现什么特征，但是可以发现它是POST请求的<br>(1)	Accept头application&#x2F;xhtml+xmlapplication&#x2F;xmlapplication&#x2F;signedexchange属于弱特征<br>(2)	ua头该特征属于弱特征。通过burp可以修改,冰蝎3.0内置的默认16个userAgent都比较 老。现实生活中很少有人使用，所以这个也可以作为waf规则特征<br>jsp抓包特征分析Content-Type: application&#x2F;octet-stream 这是一个强特征查阅 资料可知 octet-stream的意思是，只能提交二进制，而且只能提交一个二进制，如果提交 文件的话，只能提交 一个文件,后台接收参数只能有一个，而且只能是流（或者字节数组）； 很少使用。</p>
<p>log4j2原理: log4j2框架下的lookup查询服务提供了{}字段解析功能，传进去的值会被直接解析。这样不对lookup的出栈进行限制，就有可能让查询指向任何服务<br>攻击者可以利用这一点进行JNDI注入，使得受害者请求远程服务来链接本地对象，在lookup的{}里面构造payload，调用JNDI服务向攻击者提前部署好的恶意站点获取恶意的.class对象，造成了远程代码执行（可反弹shell到指定服务器）</p>
<p>getshell的方式: 文件上传,RCE,文件包含,反序列化</p>
<p>owasp top10: SQL 注入 失效的身份认证 敏感数据泄露 XXE<br>失效的访问控制 安全配置错误 XSS 不安全的反序列化<br>使用含有已知漏洞的组件 不足的日志记录和监控</p>
<p>正反向shell<br>正向Shell：攻击者连接被攻击者,可用于攻击者处于内网，被攻击者公网<br>反向 Shell：被攻击者主动连接攻击者，可用于攻击者处—-<br>正向代理，客户端代理，服务器不知道实际发起请求的客户端<br>反向代理，服务器代理，客户端不知道实际提供服务的服务端</p>
<p>域信息收集思路<br>(1)判断是否存在域 (2)定位域控 (3)域基本信息查询（所有域、域信任信息、域 密码策略） (4)域内用户查询（定位域管） (5)域内主机查询 (6)BloodHound工具</p>
<p>内网渗透思路<br>代理穿透 权限维持 信息收集 口令爆破凭据窃取 社工 横纵向移动 拿下域控</p>
<p>Windows提权<br>系统内核溢出提权<br>数据库提权<br>错误的系统配置提权<br>DLL劫持提权<br>特权第三方软件or服务提权<br>令牌窃取提权<br>web中间件漏洞提权<br>AT，SC，PS提权</p>
<p>Linux提权<br>内核溢出漏洞提权<br>Suid和guid<br>不安全的环境变量提权<br>定时任务提权<br>数据库提权</p>
<p>Shellcode免杀:编码 加壳 混淆 分离免杀 特征码修改 添加无用逻辑语句 重写api<br>分离免杀: 分为加载器和shellcode两部分,一般将shellcode存储在网页或者图片中，然后加载器远程加载存在shellcode的网页或者图片之类的</p>
<p>代理转发常用的工具<br>Frp		Neo-reGeorg		ssf	ew	Venom</p>
<p>php函数 命令执行<br>System exec shell_exec pcntl_exec popen passthru proc_open</p>
<p>session:原理<br>客户端登录后，服务器创建对应的session创建完会把 session 的id发送给客户端，客户端再存储到浏览器中。这样客户端每次访问服务器时,都会带着 sessionid，服务器拿到 sessionid 之后，在内存找到与之对应的 session</p>
<p>白银票据与黄金票据的区别<br>1.白银票据不经过KDC,因此白银日志相对黄金会少，同时白银的日志都在目标服务器上,域控上不会有日志<br>2.白银利用服务账户的哈希值,不同于黄金利用krbtgt账户的哈希值，因此白银票据更加隐蔽，但白银票据的权限就远不如黄金</p>
<p>判断出网站的 CMS 对渗透的意义<br>查找网上已曝光的程序漏洞。 如果开源，还能下载相对应的源码进行代码审计。</p>
<p>中间件漏洞<br>IIS: PUT漏洞,短文件名猜解,远程代码执行,解析漏洞<br>Apache: 解析漏洞,目录遍历等<br>Nginx:文件解析,目录遍历,CRLF注入,目录穿越<br>Tomcat: 远程代码执行,war后门文件部署<br>JBoss: 反序列化漏洞、war后门文件部署<br>WebLogic: 反序列化漏洞,SSRF任意文件上传,war后门文件部署等</p>
<p>登录页面漏洞<br>注入点以及万能密码<br>敏感信息泄露<br>验证码绕过<br>无限注册帐号<br>任意密码重置<br>明文传输<br>越权漏洞</p>
<p>fastjson原理<br>在请求包中发送恶意json格式payload，漏洞在处理json对象的时候，没有对@type过滤，导致可以传入恶意的TemplatesImpl类,这个类有一个字段就是_bytecodes，部分函数会根据这个生成java实例,达到fastjson通过字段传一个类,再通过这个类被生成时执行构造函数</p>
<p>3389端口无法连接的几种情况<br>3389关闭状态，2.端口修改，3.防火墙连接，4.处于内网环境，5.超过了服务器最大连接数，6.管理员设置权限,指定用户登录。</p>
<p>黑链: 是通过黑客行为从互联网上收集来的违法或者不良信息。这些信息包括：网站、博客、论坛、个人信息、电子邮件地址、密码、软件序列号和银行帐号等。黑链通常是通过病毒、木马、间谍软件和其他方式从计算机中盗取信息<br>危害:(1)导致许多的导出连接,由于连接联动性关系,你的网站很容易受连累,被安全网址阻止(2) 容易被IDC主机商的服务平台存在风险性连接,而被关闭网络服务器(3) 倘若一直在试着利用蓄意入侵方法得到黑链,现实意义上是一种违法行为。<br>检测: 通过查看网站源代码来，找到不明链接，一般首页权重比较高，所以黑链出现在首页的概率也比较大。</p>
<p>OSI模型和TCP&#x2F;IP体系结构<br>OSI: 物理层,数据链路层,网络层,传输层,会话层,表达层,应用层<br>TCP&#x2F;IP: 网络接口层,网络层,传输层,应用层</p>
<p>三次握手: 客户端连接服务器,先对服务器发SYN包(连接请求数据),询问是否可连接,服务器如果同意,就回复一个SYN+ACK,客户端收到后回复一个ACK包,连接建立</p>
<p>udp和tcp: udp资源占用与性能消耗少,tcp稳定可靠</p>
<p>windows下载: (1)certutil.exe (2)powershell (3)bitsadmin (4)vbs (5)ftp</p>
<p>web常用加密算法:<br>非对称加密 RSA、ElGamal、Rabin 对称加密 DES、3DES、AES 散列算法 MD5 SHA base64</p>

            
        </div>
    </div>
    <div class="post-tags">
        
        
    </div>
    <a href="/2023/04/18/蓝队面试/" class="go-post">
        阅读全文
    </a>
</div>

             
<div class="page-current">
    <div class="prev">
        
    </div>
    <div class="page-index">
        
        <span class="current">
            1
        </span>
        
    </div>
    <div class="next">
        
    </div>
</div>
        </div>
    </div>
    
    <div id="home-card">
        <div id="card-div">
    <div class="card-style" style="width: 300px">
        <div class="avatar">
            <img src="/images/avatar.jpg " alt="avatar">
        </div>
        <div class="name">
            alice01
        </div>
        <div class="descriptions">
            
            <div class="description">
                𝓼𝓬𝓪𝓽𝓽𝓮𝓻𝓮𝓭 𝓲𝓷 𝔂𝓸𝓾𝓻 𝓼𝓴𝔂
            </div>
            
        </div>
        <div class="icon-links">
            
        </div>
        <div class="friend-links">
            
        </div>
    </div>
</div>
    </div>
    
</div>
                         
<footer id="footer">
    <div class="footer-wrap">
        <div>
            © 2022 - 2023 𝓐𝓵𝓲𝓬𝓮01
            <span class="footer-icon">
                <i class="fa-solid fa-font-awesome fa-fw"></i>
            </span>
            @alice01
        </div>
        <div></div>
        <div>Based on the <a target="_blank" rel="noopener" href="https://hexo.io/">Hexo Engine</a> & <a
                target="_blank" rel="noopener" href="https://github.com/korilin/hexo-theme-particle">Particle Theme</a></div>
        
    </div>
</footer>
                    </div>
                </div>
            </transition>
            <div id="img_show">
                <img id="img_content" alt="img_show">
            </div>
        </div>
        <script src="https://cdn.staticfile.org/highlight.js/11.5.1/highlight.min.js"></script>
        <script src="/js/particlex.js"></script>
        <script src="/js/showimg.js"></script>
        

    </body>
</html>